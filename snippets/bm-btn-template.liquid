{%- assign button_default = "opacity-hover" -%}

{%- if button_template != blank -%}
  {%- assign button_template_class = "bm-btn"
    | append: "--"
    | append: button_template -%}
  {%- else -%}
    {%- assign button_template_class = "bm-btn--regular" -%}
{%- endif -%}

{%- if button_size != blank -%}
  {%- assign button_size_class = "bm-btn--" | append: button_size -%}

  {% comment %} {%- if button_size_tablet != blank or button_size_desk != blank -%}
    {%- assign button_size_class = "bm-btn-ph--" | append: button_size -%}
  {%- endif -%} {% endcomment %}
{%- endif -%}

{%- if button_size_tablet != blank -%}
  {%- assign button_size_class = button_size_class
    | append: " bm-btn-sm--"
    | append: button_size_tablet -%}
{%- endif -%}

{%- if button_size_desk != blank -%}
  {%- assign button_size_class = button_size_class
    | append: " bm-btn-xl--"
    | append: button_size_desk -%}
{%- endif -%}

{%- if button_product != blank -%}
  {%- assign button_classes = button_classes | append: ' atc__btn add-to-cart' -%}

  {%- if button_action == blank -%}
    {%- assign button_action = "add_to_cart" -%}
  {%- endif -%}

  {%- if button_content == blank -%}
    {%- assign button_content = button_action | replace: '_', ' ' | capitalize -%}
  {%- endif -%}

  {%- if button_product_two != blank -%}
    {%- assign product_array = button_product | append: '|' | append: button_product_two | split: '|' -%}
    {%- else -%}
      {%- assign product_array = button_product -%}
  {%- endif -%}

  {%- assign button_route = "" -%}

  {%- capture button_attributes -%}

    data-action="{{- button_action -}}"
    data-type="button"
    data-products='{%- render 'helper-atc-btn-items',
                      product_handles: true,
                      product_array: product_array -%}'

  {%- endcapture -%}
{%- endif -%}

{%- assign button_classes = button_classes
  | append: ' '
  | append: button_template_class
  | append: ' '
  | append: button_size_class
  | append: ' '
  | append: button_default -%}

{%- if button_route == blank -%}

  {%- if button_product_form -%}

    {%- render 'bm-atc-form',
      form_product: product,
      button_attributes: button_attributes,
      button_autofocus: button_autofocus,
      button_classes: button_classes,
      button_content: button_content,
      button_font_size: button_font_size,
      button_font_size_tablet: button_font_size_tablet,
      button_font_size_desk: button_font_size_desk,
      button_id: button_id,
      button_name: button_name,
      button_radius: button_radius,
      button_route: button_route,
      button_styles: button_styles,
      button_title: button_title,
      button_type: button_type,
      button_value: button_value,
      product_variant_selection: product_variant_selection -%}

    {%- else -%}

      {%- render 'bm-btn',
        button_attributes: button_attributes,
        button_autofocus: button_autofocus,
        button_classes: button_classes,
        button_content: button_content,
        button_font_size: button_font_size,
        button_font_size_tablet: button_font_size_tablet,
        button_font_size_desk: button_font_size_desk,
        button_id: button_id,
        button_name: button_name,
        button_radius: button_radius,
        button_route: button_route,
        button_styles: button_styles,
        button_title: button_title,
        button_type: button_type,
        button_value: button_value -%}

  {%- endif -%}

  {%- else -%}

    {%- render 'bm-btn-link',
      button_attributes: button_attributes,
      button_autofocus: button_autofocus,
      button_classes: button_classes,
      button_content: button_content,
      button_font_size: button_font_size,
      button_font_size_tablet: button_font_size_tablet,
      button_font_size_desk: button_font_size_desk,
      button_id: button_id,
      button_name: button_name,
      button_radius: button_radius,
      button_route: button_route,
      button_styles: button_styles,
      button_title: button_title,
      button_type: button_type,
      button_value: button_value -%}

{%- endif -%}
